# Recommendation Engine Explanation

## Overview
The recommendation engine in this project is designed to provide personalized and category-based video recommendations to users. It leverages user interaction data (views, likes, ratings, etc.) and content metadata to generate relevant video feeds.

---

## How It Works

### 1. **Data Collection**
- The system syncs user and post data from the external Socialverse API.
- User interactions (viewed, liked, inspired, rated posts) are regularly updated and stored in the local database.

### 2. **Personalized Feed**
- Endpoint: `/feed?username={username}`
- The engine analyzes the user's past interactions (e.g., liked, viewed, rated posts).
- It identifies topics, categories, and content types the user prefers.
- Recommendations are generated by ranking posts that match the user's interests and have not been seen yet.

### 3. **Category-based Feed**
- Endpoint: `/feed?username={username}&project_code={project_code}`
- The engine filters posts by the specified category or project code.
- It then applies the same personalization logic within that category.

### 4. **Ranking Logic**
- Posts are scored based on relevance to the user:
  - Similarity to previously liked/viewed content
  - Popularity (likes, ratings from all users)
  - Recency (newer posts are favored)
  - Diversity (to avoid showing only similar content)
- The top N posts are returned as the recommended feed.

### 5. **Model and Algorithms**
- The engine uses a combination of collaborative filtering (user-user and item-item similarities) and content-based filtering (matching post metadata to user preferences).
- Machine learning libraries like scikit-learn and pandas are used for data processing and scoring.

---

## Example Flow
1. User logs in and requests their feed.
2. The system fetches the user's interaction history.
3. The engine scores all available posts based on the logic above.
4. The highest-scoring posts are returned in the API response.

---

## Customization
- The recommendation logic can be tuned by adjusting scoring weights or adding new features (e.g., time spent on posts, explicit user feedback).
- The engine is modular and can be extended for new recommendation strategies.

---

## References
- See `app/recommendation_engine.py` for implementation details.
- API endpoints are documented in the OpenAPI docs (`/docs`).

## GNN Model Usage in Recommendations

The recommendation engine uses a Graph Neural Network (GNN) to model the relationships between users and posts. In this system:

- **Nodes** represent users and posts.
- **Edges** represent interactions (view, like, inspire, rate, bookmark) between users and posts, with weights based on interaction type and rating value.
- The GNN learns embeddings for users and posts, capturing both direct and indirect relationships in the interaction graph.
- For a given user, the engine computes a user embedding (based on their interaction history) and compares it to post embeddings using cosine similarity.
- The top-N most similar posts are recommended to the user.

This approach allows the system to:
- Capture complex user-item relationships
- Handle cold start by using average embeddings
- Adapt to new interactions as the graph evolves

The GNN model is implemented in `app/ml/gnn_model.py` and is used by the recommendation engine in `app/recommendation_engine.py`. 